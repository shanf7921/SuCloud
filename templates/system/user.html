{% extends 'layout.html' %}
{% load staticfiles %}
{% block show %}
    用户列表
{% endblock %}
{% block content %}
 <div class="row" style="width: 100%">
  <table class="table table-hover">
      <tr>
          <td></td>
          <td>序号</td>
          <td>姓名</td>
          <td>手机</td>
          <td>邮箱</td>
          <td>角色</td>
          <td>登录ID</td>
          <td>操作</td>

      </tr>
      {% for user in user_list %}
      <tr>
          <td></td>
          <td>{{ forloop.counter }}</td>
          <td>{{ user.uname }}</td>
          <td>{{ user.phone }}</td>
          <td>{{ user.email }}</td>
        {# <td>{{ user.roles.first }}</td>#}
          <td>
              {% if user.roles.first %}
              {{user.roles.first}}
              {% else %}
              {% endif %}
          </td>
          <td>{{ user.user }}</td>
          <td>
            <a href="javascript:" name="edit" onclick="edit_user(this, {{ user.id }})"><span class="glyphicon glyphicon-pencil"></span></a>
            <a href="javascript:" name="delete" onclick="del_user(this, {{ user.id }})"><span class="glyphicon glyphicon-trash" style="margin-left: 20px"></span></a>
          </td>

      </tr>
      {% endfor %}
  </table>
  </div>
    <button type="button" id="add-user-btn"  value="">新建用户</button>

        <br>
  <div class="container" id="add-user-div" style="display: none; width: 300px">
        <form class="form-horizontal" action="{% url 'account:user_register' %}" method="post">
            {% csrf_token %}
            <!--{{ form.as_p }}-->
            <div class="form-group">
                <label for="{{ form.username.id_for_label }}" class="col-md-5 control-label">
                    Username
                </label>
                <div class="col-md-6 text-left">{{ form.username }}</div>
            </div>
            <div class="form-group">
                <label for="{{ userinfo.uname.id_for_label }}" class="col-md-5 control-label">
                    姓名
                </label>
                <div class="col-md-6 text-left">{{ userinfo.uname }}</div>
            </div>
            <div class="form-group">
                <label for="{{ form.password.id_for_label }}" class="col-md-5 control-label">
                    Password
                </label>
                <div class="col-md-6 text-left">{{ form.password }}</div>
            </div>
            <div class="form-group">
                <label for="{{ form.password.id_for_label }}" class="col-md-5 control-label">
                    Confirm Password
                </label>
                <div class="col-md-6 text-left">{{ form.password2 }}</div>
            </div>
            <div class="form-group">
                <label for="{{ userinfo.phone.id_for_label }}" class="col-md-5 control-label">
                    手机
                </label>
                <div class="col-md-6 text-left">{{ userinfo.phone }}</div>
            </div>
            <div class="form-group">
                <label for="{{ userinfo.email.id_for_label }}" class="col-md-5 control-label">
                    邮箱
                </label>
                <div class="col-md-6 text-left">{{ userinfo.email }}</div>
            </div>

            <div class="form-group">
                <label for="{{ userinfo.roles.id_for_label }}" class="col-md-5 control-label">
                    角色
                </label>
                <div class="col-md-6 text-left">{{ userinfo.roles }}</div>
            </div>

            <input type="submit" class="btn btn-primary btn-lg" value="确认">
            <input type="button" id="add-user-quit" class="btn btn-primary btn-lg navbar-right" value="取消">
        </form>
    </div>



{% endblock %}

{% block js %}
    <script src="{% static 'js/system_user.js' %}"></script>
    <script type="text/javascript" src="{% static 'js/jquery.js' %}"></script>
    <script type="text/javascript" src="{% static 'layer/layer.js' %}"></script>
    <script>
        function del_column(the, user_id) {
        var name = $(the).parent("tr").children("td").eq(1).text();
        layer.open({
            title: "删除栏目",
            content: '<div class="text-center" style="margin-top: 20px"><p>是否确定删除{'+name+'}栏目</p></div>',
            btn :["确定", "取消"],
            yes:function () {
                $.ajax({
                    url: "{% url "system:user" %}",
                    type: "POST",
                    data: {"column_id": column_id},
                    success: function (e){
                        if(e=="1"){
                            parent.location.reload();
                            layer.msg("删除成功");
                        }else{
                            layer.msg("删除失败")
                        }
                    },
                });
            },
            btn2:function () {
                layer.close();
            }
        });

    }
    </script>

{% endblock %}
